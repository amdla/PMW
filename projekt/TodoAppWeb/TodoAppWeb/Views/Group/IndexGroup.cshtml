@model List<TodoAppWeb.Models.Group>

<h1>Groups</h1>

<!-- Add a button to create a new group -->
<a asp-action="CreateGroup" asp-controller="Group" class="btn btn-primary mb-3">Create New Group</a>

<ul class="list-group">
    @foreach (var group in Model)
    {
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <!-- Group Name with Link to Details -->
            <a href="@Url.Action("DetailsGroup", "Group", new { id = group.GroupId })" class="text-decoration-none">
                @group.Name
            </a>

            <!-- Edit and Delete Buttons for Groups -->
            <div>
                <a asp-action="EditGroup" asp-controller="Group" asp-route-id="@group.GroupId"
                   class="btn btn-warning btn-sm">Edit</a>
                <button class="btn btn-danger btn-sm delete-group-btn" data-group-id="@group.GroupId">Delete</button>
            </div>
        </li>
    }
</ul>

<!-- JavaScript for Handling Group Deletion -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Handle group deletion
        document.querySelectorAll('.delete-group-btn').forEach(button => {
            button.addEventListener('click', async (e) => {
                const groupId = e.target.getAttribute('data-group-id');

                if (confirm('Are you sure you want to delete this group?')) {
                    try {
                        const response = await fetch(`/Group/DeleteGroup?groupId=${groupId}`, {
                            method: 'POST'
                        });

                        if (response.ok) {
                            // Reload the page to reflect the changes
                            location.reload();
                        } else {
                            alert('Failed to delete the group.');
                        }
                    } catch (error) {
                        console.error('Error deleting group:', error);
                        alert('An error occurred while deleting the group.');
                    }
                }
            });
        });
    });
</script>